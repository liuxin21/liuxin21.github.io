---
layout: post
author: liuxin
title: 1-1D Linear Convection
date: 2017-07-02
category: CFD-Python
tags: 12 steps to Navier-Stokes
---


$\frac{\partial u}{\partial t} + c \frac{\partial u}{\partial x} = 0$$


$u(x,0)=u_0(x)$. Then the exact solution of the equation is $u(x,t)=u_0(x-ct)$.

We discretize this equation in both space and time, using the Forward Difference scheme for the time derivative and the Backward Difference scheme for the space derivative. Consider discretizing the spatial coordinate $x$ into points that we index from $i=0$ to $N$, and stepping in discrete time intervals of size $\Delta t$.

$$\frac{\partial u}{\partial x}\approx \frac{u(x+\Delta x)-u(x)}{\Delta x}$$

$$\frac{u_i^{n+1}-u_i^n}{\Delta t} + c \frac{u_i^n - u_{i-1}^n}{\Delta x} = 0 $$

Where $n$ and $n+1$ are two consecutive steps in time, while $i-1$ and $i$ are two neighboring points of the discretized $x$ coordinate. If there are given initial conditions, then the only unknown in this discretization is $u_i^{n+1}$.  We can solve for our unknown to get an equation that allows us to advance in time, as follows:

$$u_i^{n+1} = u_i^n - c \frac{\Delta t}{\Delta x}(u_i^n-u_{i-1}^n)$$

# * `numpy` is a library that provides a bunch of useful matrix operations akin to MATLAB
# * `matplotlib` is a 2D plotting library that we will use to plot our results
# * `time` and `sys` provide basic timing functions that we'll use to slow down animations for